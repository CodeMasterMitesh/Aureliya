(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{7671:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return a(3029)}])},3486:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(5893);function s(e){let{as:t="button",variant:a="outline",className:s="",...n}=e;return(0,r.jsx)(t,{className:"".concat("inline-flex items-center justify-center rounded-md text-sm transition"," ").concat("solid"===a?"bg-blue-600 text-white hover:bg-blue-700 border border-blue-600":"border border-neutral-300 dark:border-neutral-700 hover:bg-neutral-50 dark:hover:bg-neutral-900"," ").concat(s),...n})}},3029:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var r=a(5893),s=a(1664),n=a.n(s),l=a(7294),i=a(3486),c=a(8145),o=a(3514),d=a(452);async function u(){let{data:e}=await d.Z.get("/cart");return e}async function m(e){let{slug:t,qty:a=1}=e,{data:r}=await d.Z.post("/cart/add",{slug:t,qty:a});return r}async function x(e){let{slug:t,qty:a}=e,{data:r}=await d.Z.put("/cart/qty",{slug:t,qty:a});return r}async function p(){let{data:e}=await d.Z.delete("/cart");return e}async function h(e){let{name:t,email:a,password:r}=e,{data:s}=await d.Z.post("/auth/register",{name:t,email:a,password:r});return(null==s?void 0:s.token)&&localStorage.setItem("access_token",s.token),s}async function g(e){let{email:t,password:a}=e,{data:r}=await d.Z.post("/auth/login",{email:t,password:a});return(null==r?void 0:r.token)&&localStorage.setItem("access_token",r.token),r}var b=a(6006),j=a(1163);function f(){let e=(0,c.j)(e=>e.items),t=(0,c.j)(e=>e.setItems),a=(0,c.j)(e=>e.increment),s=(0,c.j)(e=>e.decrement),f=(0,c.j)(e=>e.remove),N=(0,c.j)(e=>e.clear),w=(0,c.j)(e=>e.total()),y=(0,o.a)(e=>e.token),v=(0,o.a)(e=>e.login),k=(0,j.useRouter)(),[C,q]=(0,l.useState)(!1),[_,S]=(0,l.useState)("login"),[Z,I]=(0,l.useState)({name:"",email:"",password:""});return(0,l.useEffect)(()=>{y&&(async()=>{try{let e=((await u()).items||[]).map(e=>({slug:e.product.slug,title:e.product.title,image:e.product.image,price:e.product.price,qty:e.qty}));t(e)}catch(e){console.error("Failed to sync cart",e)}})()},[y]),(0,r.jsxs)("section",{className:"container container-padding py-10",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"Your Cart"}),0===e.length?(0,r.jsxs)("div",{className:"mt-8 rounded-xl border border-dashed border-neutral-300 dark:border-neutral-800 p-8 text-center",children:[(0,r.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400",children:"Your cart is empty."}),(0,r.jsx)(i.Z,{as:n(),href:"/products",variant:"solid",className:"mt-4",children:"Shop products"})]}):(0,r.jsxs)("div",{className:"mt-8 grid gap-8 lg:grid-cols-[1fr_360px]",children:[(0,r.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-4 rounded-xl border border-neutral-200/70 dark:border-neutral-800 p-4",children:[(0,r.jsx)("img",{src:e.image,alt:"",className:"h-20 w-20 rounded-lg object-cover"}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)(n(),{href:"/product/".concat(e.slug),className:"line-clamp-1 font-medium hover:text-blue-600",children:e.title}),(0,r.jsxs)("div",{className:"mt-1 text-sm text-neutral-500",children:["₹",(e.price||0).toLocaleString("en-IN")]}),(0,r.jsxs)("div",{className:"mt-3 inline-flex items-center gap-2",children:[(0,r.jsx)(i.Z,{variant:"outline",className:"h-8 w-8 p-0","aria-label":"Decrease",onClick:async()=>{y&&await x({slug:e.slug,qty:(e.qty||0)-1}),s(e.slug)},children:"-"}),(0,r.jsx)("span",{className:"w-8 text-center tabular-nums",children:e.qty}),(0,r.jsx)(i.Z,{variant:"outline",className:"h-8 w-8 p-0","aria-label":"Increase",onClick:async()=>{y&&await m({slug:e.slug,qty:1}),a(e.slug)},children:"+"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,r.jsxs)("div",{className:"font-semibold",children:["₹",((e.price||0)*(e.qty||0)).toLocaleString("en-IN")]}),(0,r.jsx)("button",{className:"text-sm text-red-600 hover:underline",onClick:async()=>{y&&await x({slug:e.slug,qty:0}),f(e.slug)},children:"Remove"})]})]},e.slug))}),(0,r.jsxs)("aside",{className:"h-fit rounded-xl border border-neutral-200/70 dark:border-neutral-800 p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Summary"}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-between text-sm text-neutral-600 dark:text-neutral-400",children:[(0,r.jsx)("span",{children:"Subtotal"}),(0,r.jsxs)("span",{children:["₹",w.toLocaleString("en-IN")]})]}),(0,r.jsxs)("div",{className:"mt-2 flex items-center justify-between text-sm text-neutral-600 dark:text-neutral-400",children:[(0,r.jsx)("span",{children:"Shipping"}),(0,r.jsx)("span",{children:"Calculated at checkout"})]}),(0,r.jsx)("div",{className:"mt-4 border-t border-neutral-200 dark:border-neutral-800"}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-between text-base font-semibold",children:[(0,r.jsx)("span",{children:"Total"}),(0,r.jsxs)("span",{children:["₹",w.toLocaleString("en-IN")]})]}),(0,r.jsx)(i.Z,{variant:"solid",className:"mt-6 w-full",onClick:async()=>{if(!y){q(!0);return}k.push("/checkout")},children:"Checkout"}),(0,r.jsx)("button",{className:"mt-3 w-full text-sm text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300",onClick:async()=>{y&&await p(),N()},children:"Clear cart"})]})]}),C&&(0,r.jsxs)("div",{role:"dialog","aria-modal":"true",className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,r.jsx)("button",{className:"absolute inset-0 bg-black/50","aria-label":"Close",onClick:()=>q(!1)}),(0,r.jsxs)("div",{className:"relative z-10 w-full max-w-md rounded-xl border border-neutral-200/70 dark:border-neutral-800 bg-white dark:bg-neutral-950 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"login"===_?"Login":"Register"}),(0,r.jsx)("button",{className:"text-sm text-blue-600",onClick:()=>S("login"===_?"register":"login"),children:"login"===_?"Create account":"Have an account? Login"})]}),(0,r.jsxs)("form",{className:"mt-4 grid gap-3",onSubmit:async a=>{a.preventDefault();try{let a;a="login"===_?await g({email:Z.email,password:Z.password}):await h({name:Z.name,email:Z.email,password:Z.password}),v(a);let r=await Promise.all(e.map(async e=>({product:(await (0,b.M)(e.slug))._id,qty:e.qty||1,price:e.price||0})));r.length>0&&await d.Z.post("/auth/merge-cart",{userId:a.user.id,items:r});let s=((await u()).items||[]).map(e=>({slug:e.product.slug,title:e.product.title,image:e.product.image,price:e.product.price,qty:e.qty}));t(s),q(!1),k.push("/checkout")}catch(e){alert("Authentication failed")}},children:["register"===_&&(0,r.jsx)("input",{value:Z.name,onChange:e=>I({...Z,name:e.target.value}),placeholder:"Name",className:"rounded-md border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2 text-sm",required:!0}),(0,r.jsx)("input",{type:"email",value:Z.email,onChange:e=>I({...Z,email:e.target.value}),placeholder:"Email",className:"rounded-md border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2 text-sm",required:!0}),(0,r.jsx)("input",{type:"password",value:Z.password,onChange:e=>I({...Z,password:e.target.value}),placeholder:"Password",className:"rounded-md border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2 text-sm",required:!0}),(0,r.jsx)(i.Z,{type:"submit",variant:"solid",children:"login"===_?"Login":"Register"})]})]})]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=7671)}),_N_E=e.O()}]);
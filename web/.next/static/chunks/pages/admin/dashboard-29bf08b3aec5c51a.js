(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[189],{4328:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/dashboard",function(){return s(7879)}])},5710:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var n=s(5893),a=s(7294),l=s(3514),i=s(1664),r=s.n(i);function d(){let e=(0,l.a)(e=>e.user),t=(0,l.a)(e=>e.logout),[s,i]=(0,a.useState)(!1),d=(0,a.useRef)(null);return(0,a.useEffect)(()=>{function e(e){d.current&&!d.current.contains(e.target)&&i(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,n.jsx)("div",{className:"flex items-center justify-end px-4 py-2 bg-slate-900 border-b border-slate-800",children:(0,n.jsxs)("div",{className:"relative",ref:d,children:[(0,n.jsxs)("button",{onClick:()=>i(e=>!e),className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-slate-800 text-slate-200 hover:bg-slate-700",children:[(0,n.jsx)("img",{src:(null==e?void 0:e.profileImage)||"/default-avatar.png",alt:"avatar",className:"w-8 h-8 rounded-full object-cover border border-slate-700"}),(0,n.jsx)("span",{className:"text-sm font-medium hidden sm:inline-block",children:(null==e?void 0:e.name)||"Admin"}),(0,n.jsx)("span",{className:"text-xs opacity-70",children:"▾"})]}),s&&(0,n.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow border p-2 z-50",children:[(0,n.jsx)("div",{className:"px-2 py-1 text-xs text-slate-500",children:"Account"}),(0,n.jsxs)(r(),{href:"/admin/setup",className:"flex items-center gap-2 px-2 py-2 rounded hover:bg-slate-100 text-sm",children:[(0,n.jsx)("span",{children:"⚙️"})," ",(0,n.jsx)("span",{children:"Setup"})]}),(0,n.jsxs)("button",{onClick:()=>{t()},className:"flex w-full text-left items-center gap-2 px-2 py-2 rounded hover:bg-slate-100 text-sm",children:[(0,n.jsx)("span",{children:"\uD83D\uDEAA"})," ",(0,n.jsx)("span",{children:"Logout"})]})]})]})})}},7073:function(e,t,s){"use strict";s.d(t,{Z:function(){return v}});var n=s(5893),a=s(7294),l=s(1664),i=s.n(l),r=s(1163),d=s(5111),c=s(4221),o=s(3114);let u="admin_sidebar_state",m=()=>{try{return JSON.parse(localStorage.getItem(u))||{collapsed:!1,open:{}}}catch(e){return{collapsed:!1,open:{}}}},x=e=>{localStorage.setItem(u,JSON.stringify(e))};function h(e){let{open:t}=e;return(0,n.jsx)(c.E.span,{animate:{rotate:t?90:0},transition:{duration:.2},className:"inline-block",children:"▸"})}function p(e){let{node:t,depth:s=0,activePath:a,openMap:l,toggle:r,collapsed:d}=e,u=!t.submenus||0===t.submenus.length,m="sub:".concat(t._id),x=!!l[m],v=!!(a&&t.path&&a.startsWith(t.path)),g=(0,n.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-xl transition-all duration-300 ease-in-out ".concat(v?"bg-slate-700 text-white":"text-slate-200 hover:bg-slate-800/80"),onClick:()=>!u&&r(m),children:[!u&&(0,n.jsx)(h,{open:x}),!d&&(0,n.jsx)("span",{className:"text-sm font-medium truncate",children:t.name})]});return u?(0,n.jsx)(i(),{href:t.path||"#",title:d?t.name:void 0,className:"block",children:g}):(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{title:d?t.name:void 0,className:"w-full text-left",children:g}),(0,n.jsx)(o.M,{initial:!1,children:x&&!d&&(0,n.jsx)(c.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.25},className:"ml-3 pl-2 border-l border-slate-700 space-y-1",children:(t.submenus||[]).map(e=>(0,n.jsx)(p,{node:e,depth:s+1,activePath:a,openMap:l,toggle:r,collapsed:d},e._id))},"content")})]})}function v(){let[e,t]=(0,a.useState)([]),[{collapsed:s,open:l},i]=(0,a.useState)(m),u=(0,r.useRouter)().asPath;(0,a.useEffect)(()=>{let e=!0;return(0,d.VI)().then(s=>{e&&t(s)}).catch(()=>{}),()=>{e=!1}},[]),(0,a.useEffect)(()=>{x({collapsed:s,open:l})},[s,l]);let v=(0,a.useMemo)(()=>e,[e]),g=e=>i(t=>({...t,open:{...t.open,[e]:!t.open[e]}})),f=e=>g("main:".concat(e));return(0,n.jsxs)("aside",{className:"".concat(s?"w-16":"w-64"," sticky top-0 self-start h-screen overflow-y-auto bg-slate-900 border-r border-slate-800 p-2 transition-all duration-300"),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between px-2 mb-2",children:[!s&&(0,n.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Menu"}),(0,n.jsx)("button",{className:"text-slate-300 hover:text-white hover:bg-slate-800 rounded-lg p-1 transition-colors",onClick:()=>i(e=>({...e,collapsed:!e.collapsed})),title:s?"Expand sidebar":"Collapse sidebar",children:s?"\xbb":"\xab"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[v.map(e=>{var t,a;let i=!!l["main:".concat(e._id)],r=((null===(t=e.icon)||void 0===t?void 0:t[0])||(null===(a=e.name)||void 0===a?void 0:a[0])||"•").toUpperCase();return(0,n.jsxs)("div",{children:[(0,n.jsxs)("button",{className:"w-full flex items-center gap-3 px-3 py-2 rounded-xl text-left transition-all duration-300 ease-in-out ".concat(i?"bg-slate-800 text-white":"text-slate-200 hover:bg-slate-800/60"),onClick:()=>f(e._id),title:s?e.name:void 0,children:[(0,n.jsx)("div",{className:"w-7 h-7 rounded-md bg-slate-800/80 text-slate-200 grid place-items-center text-sm",children:r}),!s&&(0,n.jsx)("div",{className:"font-semibold text-sm truncate flex-1",children:e.name}),!s&&(0,n.jsx)(h,{open:i})]}),(0,n.jsx)(o.M,{initial:!1,children:i&&!s&&(0,n.jsx)(c.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.25},className:"mt-1 ml-2 space-y-1",children:(e.submenus||[]).map(e=>(0,n.jsx)(p,{node:e,activePath:u,openMap:l,toggle:g,collapsed:s},e._id))})})]},e._id)}),0===v.length&&(0,n.jsx)("div",{className:"px-3 py-2 text-xs text-slate-400",children:"Loading menus..."})]})]})}},7879:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var n=s(5893),a=s(7294),l=s(1163),i=s(7073),r=s(5710),d=s(452);let c=async()=>{let{data:e}=await d.ZP.get("/admin/dashboard");return e};var o=s(3514);function u(e){let{data:t}=e,s=Math.max(1,...t.map(e=>e.total));return(0,n.jsx)("div",{className:"h-40 flex items-end gap-1",children:t.map(e=>(0,n.jsx)("div",{className:"flex-1 bg-blue-200",style:{height:"".concat(e.total/s*100,"%")},title:"Day ".concat(e.day,": ").concat(e.total)},e.day))})}function m(e){let{data:t}=e,s=Object.entries(t),a=s.reduce((e,t)=>{let[,s]=t;return e+s},0);if(!a)return(0,n.jsx)("div",{className:"text-sm text-gray-500",children:"No data"});let l=["#0ea5e9","#22c55e","#f59e0b","#ef4444","#6366f1"];return(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"w-32 h-32 rounded-full bg-gray-100 relative",style:{background:"conic-gradient(".concat(s.map((e,t)=>{let[s,n]=e;return"".concat(l[t%l.length]," ").concat(n/a*100,"%")}).join(","),")")}}),(0,n.jsx)("div",{className:"text-sm space-y-1",children:s.map((e,t)=>{let[s,a]=e;return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"w-3 h-3 inline-block rounded-sm",style:{background:l[t%l.length]}})," ",s,": ",a]},s)})})]})})}function x(){var e,t,s,d,x,h,p,v;let[g,f]=(0,a.useState)(null),[b,j]=(0,a.useState)(!0),N=(0,l.useRouter)(),y=(0,o.a)(e=>e.user);return((0,a.useEffect)(()=>{let e=!0;return async function(){try{let t=await c();e&&f(t)}catch(s){var t;let e=null==s?void 0:null===(t=s.response)||void 0===t?void 0:t.status;(401===e||403===e)&&N.replace("/login")}finally{e&&j(!1)}}(),()=>{e=!1}},[y]),b)?(0,n.jsx)("div",{className:"min-h-[70vh] flex items-center justify-center",children:"Loading..."}):(0,n.jsxs)("div",{className:"min-h-[70vh] flex",children:[(0,n.jsx)(i.Z,{}),(0,n.jsxs)("main",{className:"flex-1",children:[(0,n.jsx)(r.Z,{}),(0,n.jsxs)("div",{className:"p-4 space-y-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold",children:"Admin Dashboard"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[(0,n.jsxs)("div",{className:"p-4 border rounded bg-white",children:[(0,n.jsx)("div",{className:"text-gray-500 text-sm",children:"Today's Orders"}),(0,n.jsx)("div",{className:"text-2xl font-bold",children:null!==(x=null==g?void 0:null===(e=g.cards)||void 0===e?void 0:e.todayOrders)&&void 0!==x?x:"-"})]}),(0,n.jsxs)("div",{className:"p-4 border rounded bg-white",children:[(0,n.jsx)("div",{className:"text-gray-500 text-sm",children:"This Week Orders"}),(0,n.jsx)("div",{className:"text-2xl font-bold",children:null!==(h=null==g?void 0:null===(t=g.cards)||void 0===t?void 0:t.weekOrders)&&void 0!==h?h:"-"})]}),(0,n.jsxs)("div",{className:"p-4 border rounded bg-white",children:[(0,n.jsx)("div",{className:"text-gray-500 text-sm",children:"This Month Orders"}),(0,n.jsx)("div",{className:"text-2xl font-bold",children:null!==(p=null==g?void 0:null===(s=g.cards)||void 0===s?void 0:s.monthOrders)&&void 0!==p?p:"-"})]}),(0,n.jsxs)("div",{className:"p-4 border rounded bg-white",children:[(0,n.jsx)("div",{className:"text-gray-500 text-sm",children:"Low Stock Products"}),(0,n.jsx)("div",{className:"text-2xl font-bold",children:null!==(v=null==g?void 0:null===(d=g.cards)||void 0===d?void 0:d.lowStock)&&void 0!==v?v:"-"})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{className:"border rounded bg-white p-4 lg:col-span-2",children:[(0,n.jsx)("div",{className:"font-semibold mb-2",children:"Sales by Day (This Month)"}),g?(0,n.jsx)(u,{data:g.charts.salesByDay}):(0,n.jsx)("div",{className:"h-40 bg-gray-50 rounded"})]}),(0,n.jsxs)("div",{className:"border rounded bg-white p-4",children:[(0,n.jsx)("div",{className:"font-semibold mb-2",children:"Orders by Status"}),g?(0,n.jsx)(m,{data:g.charts.ordersByStatus}):(0,n.jsx)("div",{className:"h-40 bg-gray-50 rounded"})]})]})]})]})]})}},5111:function(e,t,s){"use strict";s.d(t,{Dr:function(){return i},Ft:function(){return l},Hz:function(){return r},Io:function(){return o},VI:function(){return a},bA:function(){return u},h3:function(){return m},rq:function(){return d},wC:function(){return c}});var n=s(452);let a=async()=>{let{data:e}=await n.ZP.get("/menus");return e.items},l=async e=>{let{data:t}=await n.ZP.get("/main-menus",{params:e});return t},i=async e=>{let{data:t}=await n.ZP.get("/sub-menus",{params:e});return t},r=e=>n.ZP.post("/main-menus",e),d=(e,t)=>n.ZP.put("/main-menus/".concat(e),t),c=e=>n.ZP.delete("/main-menus/".concat(e)),o=e=>n.ZP.post("/sub-menus",e),u=(e,t)=>n.ZP.put("/sub-menus/".concat(e),t),m=e=>n.ZP.delete("/sub-menus/".concat(e))}},function(e){e.O(0,[738,888,774,179],function(){return e(e.s=4328)}),_N_E=e.O()}]);
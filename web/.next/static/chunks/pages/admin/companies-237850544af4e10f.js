(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[549],{2145:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/companies",function(){return n(5925)}])},5925:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var o=n(5893),a=n(7294),i=n(1163),r=n(6455),s=n.n(r),l=n(7073),c=n(5710),d=n(9559),u=n(6656),m=n(8384),f=n(3281),h=n(6088);function p(){let e=(0,i.useRouter)(),t=(0,f.a)(e=>e.token),[n,r]=(0,a.useState)([]),[p,x]=(0,a.useState)(1),[v,y]=(0,a.useState)(1),[w,b]=(0,a.useState)(0),[g]=(0,a.useState)(20),[C,j]=(0,a.useState)(""),[k,N]=(0,a.useState)(""),[B,S]=(0,a.useState)(""),[Z,P]=(0,a.useState)(!0),[_,E]=(0,a.useState)(null),[A,D]=(0,a.useState)(!1),[F,L]=(0,a.useState)(new Set);async function M(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;P(!0);try{let{items:e,pages:n,total:o,page:a}=await (0,h.ZU)({page:t,limit:g,search:C,name:k||void 0,code:B||void 0});r(e),y(n),b(o),x(a),L(new Set)}catch(o){var n;let t=null==o?void 0:null===(n=o.response)||void 0===n?void 0:n.status;(401===t||403===t)&&e.replace("/admin/login"),await s().fire({icon:"error",title:"Error",text:"Failed to load companies. Please try again.",confirmButtonColor:"#3b82f6"})}finally{P(!1)}}(0,a.useEffect)(()=>{t||e.replace("/admin/login")},[t]),(0,a.useEffect)(()=>{M(1)},[C,k,B]);let T=e=>{E(e),D(!0)},H=async e=>{if((await s().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await (0,h.oR)(e),await s().fire({icon:"success",title:"Deleted!",text:"Company has been deleted.",timer:2e3,showConfirmButton:!1}),M(p)}catch(e){var t,n;await s().fire({icon:"error",title:"Error",text:(null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.error)||"Failed to delete company.",confirmButtonColor:"#3b82f6"})}},R=async e=>{if((await s().fire({title:"Are you sure?",text:"You are about to delete ".concat(e.length," company(ies). This action cannot be undone!"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete ".concat(e.length," item(s)!")})).isConfirmed)try{await (0,h.xC)(e),await s().fire({icon:"success",title:"Deleted!",text:"".concat(e.length," company(ies) have been deleted."),timer:2e3,showConfirmButton:!1}),M(p)}catch(e){var t,n;await s().fire({icon:"error",title:"Error",text:(null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.error)||"Failed to delete companies.",confirmButtonColor:"#3b82f6"})}},U=async e=>{try{_?(await (0,h.j1)(_._id,e),await s().fire({icon:"success",title:"Updated!",text:"Company has been updated successfully.",timer:2e3,showConfirmButton:!1})):(await (0,h.e5)(e),await s().fire({icon:"success",title:"Created!",text:"Company has been created successfully.",timer:2e3,showConfirmButton:!1})),D(!1),E(null),M(1)}catch(e){var t,n;await s().fire({icon:"error",title:"Error",text:(null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.error)||"Failed to save company.",confirmButtonColor:"#3b82f6"})}},Y=(0,a.useMemo)(()=>[{key:"name",label:"Name"},{key:"code",label:"Code"},{key:"address",label:"Address"}],[]),O=(0,a.useMemo)(()=>[{key:"name",label:"Name",required:!0,placeholder:"Enter company name"},{key:"code",label:"Code",placeholder:"Enter company code"},{key:"address",label:"Address",type:"textarea",rows:4,placeholder:"Enter company address"}],[]),W=(0,a.useMemo)(()=>[{title:"Company Information",fields:O}],[O]),z=(0,a.useMemo)(()=>[{key:"name",label:"Name",type:"text",value:k,placeholder:"Filter by name"},{key:"code",label:"Code",type:"text",value:B,placeholder:"Filter by code"}],[k,B]);return t?(0,o.jsxs)("div",{className:"min-h-screen flex bg-gray-50",children:[(0,o.jsx)(l.Z,{}),(0,o.jsxs)("main",{className:"flex-1 flex flex-col",children:[(0,o.jsx)(c.Z,{}),(0,o.jsxs)("div",{className:"p-6 space-y-6",children:[(0,o.jsx)(m.Z,{items:[{label:"Dashboard",href:"/admin/dashboard",icon:"\uD83C\uDFE0"},{label:"Companies"}]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Companies"}),(0,o.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your companies"})]}),(0,o.jsxs)("button",{onClick:()=>{E(null),D(!0)},className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Company"]})]}),(0,o.jsx)(d.Z,{title:"Companies",columns:Y,data:n,loading:Z,pagination:{page:p,pages:v,total:w,limit:g},onPageChange:e=>{x(e),M(e)},filters:z,onFilterChange:(e,t)=>{"name"===e?N(t):"code"===e&&S(t)},selectable:!0,selectedIds:F,onToggleRow:(e,t)=>{let n=new Set(F);t?n.add(e._id):n.delete(e._id),L(n)},onToggleAll:e=>{e?L(new Set(n.map(e=>e._id))):L(new Set)},onBulkDelete:R,exportFileName:"companies",showSearch:!0,searchPlaceholder:"Search companies...",actions:e=>(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsxs)("button",{onClick:()=>T(e),className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium flex items-center gap-1",children:[(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),(0,o.jsxs)("button",{onClick:()=>H(e._id),className:"px-3 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium flex items-center gap-1",children:[(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})})]})]}),(0,o.jsx)(u.Z,{isOpen:A,onClose:()=>{D(!1),E(null)},onSubmit:U,title:_?"Edit Company":"Add New Company",sections:W,initialData:_?{name:_.name||"",code:_.code||"",address:_.address||""}:{name:"",code:"",address:""},submitLabel:_?"Update Company":"Create Company"})]}):null}},6088:function(e,t,n){"use strict";n.d(t,{Ao:function(){return a},Di:function(){return p},NA:function(){return h},Pz:function(){return s},Qj:function(){return m},ZU:function(){return r},e5:function(){return l},j1:function(){return c},oR:function(){return d},o_:function(){return f},oe:function(){return i},xC:function(){return u}});var o=n(452);let a=async e=>{try{let{data:t}=await o.ZP.get("/companies",{params:{search:e,limit:200}});return t.items}catch(e){return[]}},i=async e=>{if(!e)return[];try{let{data:t}=await o.ZP.get("/companies/".concat(e,"/branches"));return t.items}catch(e){return[]}},r=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{data:t}=await o.ZP.get("/companies",{params:e});return t},s=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{data:t}=await o.ZP.get("/branches",{params:e});return t},l=e=>o.ZP.post("/companies",e),c=(e,t)=>o.ZP.put("/companies/".concat(e),t),d=e=>o.ZP.delete("/companies/".concat(e)),u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return o.ZP.delete("/companies",{data:{ids:e}})},m=e=>o.ZP.post("/branches",e),f=(e,t)=>o.ZP.put("/branches/".concat(e),t),h=e=>o.ZP.delete("/branches/".concat(e)),p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return o.ZP.delete("/branches",{data:{ids:e}})}}},function(e){e.O(0,[166,251,664,738,56,888,774,179],function(){return e(e.s=2145)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[571],{8734:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/sub-menus",function(){return n(1773)}])},1773:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var a=n(5893),l=n(7294),i=n(1163),r=n(6455),o=n.n(r),s=n(7073),u=n(5710),d=n(9559),c=n(6656),m=n(8384),h=n(3514),b=n(5111);function p(){let e=(0,i.useRouter)(),t=(0,h.a)(e=>e.token),[n,r]=(0,l.useState)([]),[p,f]=(0,l.useState)(1),[v,x]=(0,l.useState)(1),[g,_]=(0,l.useState)(0),[w]=(0,l.useState)(20),[y,S]=(0,l.useState)(""),[k,j]=(0,l.useState)(""),[M,C]=(0,l.useState)(""),[N,E]=(0,l.useState)([]),[B,P]=(0,l.useState)(!0),[L,A]=(0,l.useState)(null),[D,F]=(0,l.useState)(!1),[O,T]=(0,l.useState)(new Set);async function Z(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;P(!0);try{let{items:e,pages:n,total:a,page:l}=await (0,b.Dr)({page:t,limit:w,search:y,main_menu_id:k||void 0,parent_id:M||void 0});r(e),x(n),_(a),f(l),T(new Set)}catch(a){var n;let t=null==a?void 0:null===(n=a.response)||void 0===n?void 0:n.status;(401===t||403===t)&&e.replace("/admin/login"),await o().fire({icon:"error",title:"Error",text:"Failed to load sub menus. Please try again.",confirmButtonColor:"#3b82f6"})}finally{P(!1)}}(0,l.useEffect)(()=>{t||e.replace("/admin/login")},[t]),(0,l.useEffect)(()=>{(async()=>{let{items:e}=await (0,b.Ft)({limit:200});E(e)})()},[]),(0,l.useEffect)(()=>{Z(1)},[y,k,M]);let H=e=>{A(e),F(!0)},I=async e=>{if((await o().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await (0,b.h3)(e),await o().fire({icon:"success",title:"Deleted!",text:"Sub menu has been deleted.",timer:2e3,showConfirmButton:!1}),Z(p)}catch(e){var t,n;await o().fire({icon:"error",title:"Error",text:(null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.error)||"Failed to delete sub menu.",confirmButtonColor:"#3b82f6"})}},W=async e=>{try{L?(await (0,b.bA)(L._id,e),await o().fire({icon:"success",title:"Updated!",text:"Sub menu has been updated successfully.",timer:2e3,showConfirmButton:!1})):(await (0,b.Io)(e),await o().fire({icon:"success",title:"Created!",text:"Sub menu has been created successfully.",timer:2e3,showConfirmButton:!1})),F(!1),A(null),Z(1)}catch(e){var t,n;await o().fire({icon:"error",title:"Error",text:(null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.error)||"Failed to save sub menu.",confirmButtonColor:"#3b82f6"})}},q=(0,l.useMemo)(()=>[{key:"name",label:"Name"},{key:"slug",label:"Slug"},{key:"path",label:"Path"},{key:"order",label:"Order"},{key:"main_menu_id",label:"Main Menu",render:e=>{var t;return(null===(t=N.find(t=>t._id===e))||void 0===t?void 0:t.name)||""}},{key:"parent_id",label:"Parent",render:e=>{var t;return(null===(t=n.find(t=>t._id===e))||void 0===t?void 0:t.name)||"-"}}],[N,n]),R=(0,l.useMemo)(()=>[{key:"main_menu_id",label:"Main Menu",type:"select",required:!0,options:N.map(e=>({value:e._id,label:e.name})),placeholder:"Select main menu"},{key:"parent_id",label:"Parent (optional)",type:"select",options:[{value:"",label:"None"},...n.filter(e=>!e.parent_id).map(e=>({value:e._id,label:e.name}))],placeholder:"Select parent menu"},{key:"name",label:"Name",required:!0,placeholder:"Enter sub menu name"},{key:"slug",label:"Slug",placeholder:"Enter slug"},{key:"path",label:"Path",placeholder:"Enter path"},{key:"order",label:"Order",type:"number",placeholder:"Enter display order",defaultValue:0}],[N,n]),U=(0,l.useMemo)(()=>[{title:"Sub Menu Information",fields:R}],[R]),V=(0,l.useMemo)(()=>[{key:"main_menu_id",label:"Main Menu",type:"select",value:k,options:[{value:"",label:"All Main Menus"},...N.map(e=>({value:e._id,label:e.name}))]},{key:"parent_id",label:"Parent",type:"select",value:M,options:[{value:"",label:"All Parents"},...n.filter(e=>!e.parent_id).map(e=>({value:e._id,label:e.name}))]}],[k,M,N,n]);return t?(0,a.jsxs)("div",{className:"min-h-screen flex bg-gray-50",children:[(0,a.jsx)(s.Z,{}),(0,a.jsxs)("main",{className:"flex-1 flex flex-col",children:[(0,a.jsx)(u.Z,{}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsx)(m.Z,{items:[{label:"Dashboard",href:"/admin/dashboard",icon:"\uD83C\uDFE0"},{label:"Sub Menus"}]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Sub Menus"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your sub navigation menus"})]}),(0,a.jsxs)("button",{onClick:()=>{A(null),F(!0)},className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Sub Menu"]})]}),(0,a.jsx)(d.Z,{title:"Sub Menus",columns:q,data:n,loading:B,pagination:{page:p,pages:v,total:g,limit:w},onPageChange:e=>{f(e),Z(e)},filters:V,onFilterChange:(e,t)=>{"main_menu_id"===e?j(t):"parent_id"===e&&C(t)},selectable:!0,selectedIds:O,onToggleRow:(e,t)=>{let n=new Set(O);t?n.add(e._id):n.delete(e._id),T(n)},onToggleAll:e=>{e?T(new Set(n.map(e=>e._id))):T(new Set)},exportFileName:"sub-menus",showSearch:!0,searchPlaceholder:"Search sub menus...",actions:e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>H(e),className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium flex items-center gap-1",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),(0,a.jsxs)("button",{onClick:()=>I(e._id),className:"px-3 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium flex items-center gap-1",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})})]})]}),(0,a.jsx)(c.Z,{isOpen:D,onClose:()=>{F(!1),A(null)},onSubmit:W,title:L?"Edit Sub Menu":"Add New Sub Menu",sections:U,initialData:L?{main_menu_id:L.main_menu_id||"",parent_id:L.parent_id||"",name:L.name||"",slug:L.slug||"",path:L.path||"",order:L.order||0}:{main_menu_id:"",parent_id:"",name:"",slug:"",path:"",order:0},submitLabel:L?"Update Sub Menu":"Create Sub Menu"})]}):null}}},function(e){e.O(0,[166,251,738,56,888,774,179],function(){return e(e.s=8734)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[300],{8786:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/login",function(){return n(8241)}])},8241:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return c}});var t=n(5893),s=n(7294),l=n(1163),r=n(452);let i=async e=>{let{data:a}=await r.Z.get("/companies",{params:{search:e}});return a.items},d=async e=>{if(!e)return[];let{data:a}=await r.Z.get("/companies/".concat(e,"/branches"));return a.items};function c(){let e=(0,l.useRouter)(),[a,n]=(0,s.useState)([]),[c,o]=(0,s.useState)([]),[u,m]=(0,s.useState)({identifier:"",password:"",companyId:"",branchId:""}),[h,p]=(0,s.useState)(""),[x,b]=(0,s.useState)(!1);(0,s.useEffect)(()=>{i().then(n).catch(()=>{})},[]),(0,s.useEffect)(()=>{if(!u.companyId){o([]),m(e=>({...e,branchId:""}));return}d(u.companyId).then(o).catch(()=>o([]))},[u.companyId]);let f=async a=>{a.preventDefault(),b(!0),p("");try{let{data:a}=await r.Z.post("/auth/login",u);localStorage.setItem("access_token",a.token),e.push("/admin/dashboard")}catch(e){var n,t;p((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.error)||"Login failed")}finally{b(!1)}};return(0,t.jsx)("div",{className:"min-h-[70vh] flex items-center justify-center p-6",children:(0,t.jsxs)("form",{onSubmit:f,className:"w-full max-w-md space-y-4 border rounded p-6 bg-white shadow",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-center",children:"Admin / Employee Login"}),h&&(0,t.jsx)("div",{className:"text-sm text-red-600",children:h}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm mb-1",children:"Username or Email"}),(0,t.jsx)("input",{className:"border rounded px-3 py-2 w-full",value:u.identifier,onChange:e=>m({...u,identifier:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm mb-1",children:"Password"}),(0,t.jsx)("input",{type:"password",className:"border rounded px-3 py-2 w-full",value:u.password,onChange:e=>m({...u,password:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm mb-1",children:"Company"}),(0,t.jsxs)("select",{className:"border rounded px-3 py-2 w-full",value:u.companyId,onChange:e=>m({...u,companyId:e.target.value}),children:[(0,t.jsx)("option",{value:"",children:"Select company"}),a.map(e=>(0,t.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm mb-1",children:"Branch"}),(0,t.jsxs)("select",{className:"border rounded px-3 py-2 w-full",value:u.branchId,onChange:e=>m({...u,branchId:e.target.value}),disabled:!u.companyId,children:[(0,t.jsx)("option",{value:"",children:"Select branch"}),c.map(e=>(0,t.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,t.jsx)("button",{disabled:x,className:"w-full px-4 py-2 bg-blue-600 text-white rounded",children:x?"Signing in...":"Sign in"})]})})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=8786)}),_N_E=e.O()}]);
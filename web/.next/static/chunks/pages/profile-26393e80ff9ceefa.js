(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{9134:function(e,a,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return r(4900)}])},3486:function(e,a,r){"use strict";r.d(a,{Z:function(){return s}});var t=r(5893);function s(e){let{as:a="button",variant:r="outline",className:s="",...l}=e;return(0,t.jsx)(a,{className:"".concat("inline-flex items-center justify-center rounded-md text-sm transition"," ").concat("solid"===r?"bg-blue-600 text-white hover:bg-blue-700 border border-blue-600":"border border-neutral-300 dark:border-neutral-700 hover:bg-neutral-50 dark:hover:bg-neutral-900"," ").concat(s),...l})}},4900:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return x}});var t=r(5893),s=r(7294),l=r(1664),n=r.n(l),d=r(3486),i=r(3514),o=r(3976),c=r(452);async function u(e){let a=new FormData;a.append("file",e);let{data:r}=await c.ZP.post("/uploads/profile",a,{headers:{"Content-Type":"multipart/form-data"}});return r}var m=r(4385);function x(){var e,a;let r=(0,i.a)(e=>e.token),l=(0,i.a)(e=>e.user),c=(0,i.a)(e=>e.setUser),[x,p]=(0,s.useState)("overview"),[b,h]=(0,s.useState)(!1),[f,v]=(0,s.useState)(l||null),[j,g]=(0,s.useState)([]);if((0,s.useEffect)(()=>{(async function(){if(r){try{let e=await (0,o.jo)();v(e),c(e)}catch(e){}try{let e=await (0,m.AU)();g(e)}catch(e){}}})()},[r]),!r)return(0,t.jsxs)("section",{className:"container container-padding py-16",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold",children:"Profile"}),(0,t.jsx)("p",{className:"mt-4 text-neutral-500",children:"Please log in to view your profile."})]});async function y(e){var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];if(r){h(!0);try{let{url:e}=await u(r),a=await (0,o.DO)({profileImage:e});v(a),c(a)}catch(e){alert("Upload failed")}finally{h(!1)}}}async function N(){h(!0);try{let e=await (0,o.DO)({name:null==f?void 0:f.name});v(e),c(e),alert("Saved")}catch(e){alert("Failed to save")}finally{h(!1)}}async function w(e){e.preventDefault();let a=new FormData(e.target),r=a.get("oldPassword"),t=a.get("newPassword");if(!r||!t){alert("Enter both passwords");return}h(!0);try{await (0,o.Cp)({oldPassword:r,newPassword:t}),alert("Password changed")}catch(e){alert("Failed to change password")}finally{h(!1),e.target.reset()}}async function k(e){e.preventDefault();let a=new FormData(e.target),r={label:a.get("label")||"Home",line1:a.get("line1")||"",city:a.get("city")||"",zip:a.get("zip")||"",isDefault:"on"===a.get("isDefault")};try{await (0,o.y$)(r);let a=await (0,o.jo)();v(a),c(a),e.target.reset()}catch(e){alert("Unable to add address")}}async function _(e){try{await (0,o.y3)(e,{isDefault:!0});let a=await (0,o.jo)();v(a),c(a)}catch(e){alert("Failed to set default")}}async function D(e){if(confirm("Delete this address?"))try{await (0,o._N)(e);let a=await (0,o.jo)();v(a),c(a)}catch(e){alert("Failed to delete")}}return(0,t.jsxs)("section",{className:"container container-padding py-10",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold",children:"My Account"}),(0,t.jsxs)("div",{className:"mt-6 grid gap-8 lg:grid-cols-[280px_1fr]",children:[(0,t.jsx)("aside",{className:"rounded-xl border border-neutral-200/70 dark:border-neutral-800 p-4",children:(0,t.jsxs)("nav",{className:"space-y-2 text-sm",children:[(0,t.jsx)("button",{className:"block w-full text-left rounded-md px-3 py-2 ".concat("overview"===x?"bg-neutral-100 dark:bg-neutral-800":""),onClick:()=>p("overview"),children:"Overview"}),(0,t.jsx)("button",{className:"block w-full text-left rounded-md px-3 py-2 ".concat("addresses"===x?"bg-neutral-100 dark:bg-neutral-800":""),onClick:()=>p("addresses"),children:"Addresses"}),(0,t.jsx)("button",{className:"block w-full text-left rounded-md px-3 py-2 ".concat("security"===x?"bg-neutral-100 dark:bg-neutral-800":""),onClick:()=>p("security"),children:"Security"}),(0,t.jsx)("button",{className:"block w-full text-left rounded-md px-3 py-2 ".concat("orders"===x?"bg-neutral-100 dark:bg-neutral-800":""),onClick:()=>p("orders"),children:"Orders"})]})}),(0,t.jsxs)("div",{children:["overview"===x&&(0,t.jsxs)("div",{className:"rounded-xl border border-neutral-200/70 dark:border-neutral-800 p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"h-16 w-16 rounded-full overflow-hidden bg-neutral-200",children:(null==f?void 0:f.profileImage)?(0,t.jsx)("img",{src:(null===(e=f.profileImage)||void 0===e?void 0:e.startsWith("uploads/"))?"/"+f.profileImage:f.profileImage,alt:"avatar",className:"h-full w-full object-cover"}):null}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-neutral-500",children:"Profile photo"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:y,disabled:b,className:"block text-sm mt-1"})]})]}),(0,t.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-neutral-500",children:"Name"}),(0,t.jsx)("input",{value:(null==f?void 0:f.name)||"",onChange:e=>v({...f,name:e.target.value}),className:"mt-1 w-full rounded-md border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-neutral-500",children:"Email"}),(0,t.jsx)("input",{value:(null==f?void 0:f.email)||"",disabled:!0,className:"mt-1 w-full rounded-md border border-neutral-300 dark:border-neutral-700 bg-neutral-50 dark:bg-neutral-900/50 px-3 py-2 text-sm"})]})]}),(0,t.jsx)(d.Z,{variant:"solid",onClick:N,disabled:b,children:"Save changes"})]}),"addresses"===x&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-neutral-200/70 dark:border-neutral-800 p-6",children:[(0,t.jsx)("h2",{className:"font-semibold",children:"Saved addresses"}),(0,t.jsx)("ul",{className:"mt-4 divide-y divide-neutral-200 dark:divide-neutral-800",children:(null==f?void 0:null===(a=f.addresses)||void 0===a?void 0:a.length)?f.addresses.map(e=>(0,t.jsxs)("li",{className:"py-3 flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium text-sm",children:[e.label," ",e.isDefault&&(0,t.jsx)("span",{className:"ml-2 rounded bg-blue-100 px-2 py-0.5 text-xs text-blue-700",children:"Default"})]}),(0,t.jsxs)("div",{className:"text-sm text-neutral-500",children:[e.line1,", ",e.city," ",e.zip]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[!e.isDefault&&(0,t.jsx)(d.Z,{size:"sm",onClick:()=>_(e._id),children:"Set default"}),(0,t.jsx)(d.Z,{size:"sm",variant:"outline",onClick:()=>D(e._id),children:"Delete"})]})]},e._id)):(0,t.jsx)("li",{className:"py-3 text-sm text-neutral-500",children:"No addresses yet."})})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-neutral-200/70 dark:border-neutral-800 p-6",children:[(0,t.jsx)("h2",{className:"font-semibold",children:"Add new address"}),(0,t.jsxs)("form",{className:"mt-4 grid gap-3 sm:grid-cols-2",onSubmit:k,children:[(0,t.jsx)("input",{name:"label",placeholder:"Label (Home)",className:"rounded-md border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2 text-sm"}),(0,t.jsx)("input",{name:"line1",placeholder:"Address line",className:"sm:col-span-2 rounded-md border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2 text-sm"}),(0,t.jsx)("input",{name:"city",placeholder:"City",className:"rounded-md border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2 text-sm"}),(0,t.jsx)("input",{name:"zip",placeholder:"ZIP",className:"rounded-md border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2 text-sm"}),(0,t.jsxs)("label",{className:"sm:col-span-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",name:"isDefault",className:"mr-2"})," Set as default"]}),(0,t.jsx)("div",{className:"sm:col-span-2",children:(0,t.jsx)(d.Z,{variant:"solid",type:"submit",children:"Add address"})})]})]})]}),"security"===x&&(0,t.jsxs)("div",{className:"rounded-xl border border-neutral-200/70 dark:border-neutral-800 p-6",children:[(0,t.jsx)("h2",{className:"font-semibold",children:"Change password"}),(0,t.jsxs)("form",{className:"mt-4 grid gap-3 sm:w-96",onSubmit:w,children:[(0,t.jsx)("input",{name:"oldPassword",type:"password",placeholder:"Current password",className:"rounded-md border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2 text-sm"}),(0,t.jsx)("input",{name:"newPassword",type:"password",placeholder:"New password",className:"rounded-md border border-neutral-300 dark:border-neutral-700 bg-transparent px-3 py-2 text-sm"}),(0,t.jsx)("div",{children:(0,t.jsx)(d.Z,{variant:"solid",type:"submit",children:"Update password"})})]})]}),"orders"===x&&(0,t.jsxs)("div",{className:"rounded-xl border border-neutral-200/70 dark:border-neutral-800 p-6",children:[(0,t.jsx)("h2",{className:"font-semibold",children:"Orders"}),(0,t.jsx)("ul",{className:"mt-4 divide-y divide-neutral-200 dark:divide-neutral-800",children:(null==j?void 0:j.length)?j.map(e=>{var a;return(0,t.jsxs)("li",{className:"py-3 flex items-center justify-between gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:["#",e._id.slice(-6)," • ",new Date(e.createdAt).toLocaleString()]}),(0,t.jsxs)("div",{className:"text-neutral-500",children:[(null===(a=e.items)||void 0===a?void 0:a.length)||0," items • Total ₹",(e.total||0).toLocaleString("en-IN")," • ",e.status]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n(),{href:"/orders/".concat(e._id),className:"underline",children:"Details"}),(0,t.jsx)(n(),{href:"/invoice/".concat(e._id),className:"underline",children:"Invoice"})]})]},e._id)}):(0,t.jsx)("li",{className:"py-4 text-neutral-500 text-sm",children:"No orders yet."})})]})]})]})]})}},4385:function(e,a,r){"use strict";r.d(a,{AU:function(){return l},Ju:function(){return n},LV:function(){return s}});var t=r(452);async function s(e){let{data:a}=await t.ZP.post("/orders",e||{});return a}async function l(){let{data:e}=await t.ZP.get("/orders");return e}async function n(e){let{data:a}=await t.ZP.get("/orders/".concat(e));return a}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=9134)}),_N_E=e.O()}]);